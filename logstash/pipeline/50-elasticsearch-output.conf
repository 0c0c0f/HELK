output {
	if [@metadata][source] == "winlogbeat" {
		if [Channel] == "Microsoft-Windows-Sysmon/Operational" {
			elasticsearch {
				hosts => ["elasticsearch:9200", "127.0.0.1:9200"]
				sniffing => true
				manage_template => false 
				index => "windows_sysmon-%{+YYYY.MM.dd}"
				document_type => "%{[@metadata][type]}"
			}
		}
		if [Channel] == "System" {
			elasticsearch {
				hosts => ["elasticsearch:9200", "127.0.0.1:9200"]
				sniffing => true
				manage_template => false 
				index => "windows_system-%{+YYYY.MM.dd}"
				document_type => "%{[@metadata][type]}"
			}
		}
		if [Channel] == "Security"{
			elasticsearch {
				hosts => ["elasticsearch:9200", "127.0.0.1:9200"]
				sniffing => true
				manage_template => false 
				index => "windows_security-%{+YYYY.MM.dd}"
				document_type => "%{[@metadata][type]}"
			}
		}
		if [Channel] == "Application"{
			elasticsearch {
				hosts => ["elasticsearch:9200", "127.0.0.1:9200"]
				sniffing => true
				manage_template => false 
				index => "windows_application-%{+YYYY.MM.dd}"
				document_type => "%{[@metadata][type]}"
			}
		}
		if [Channel] == "Microsoft-Windows-PowerShell/Operational"{
			elasticsearch {
				hosts => ["elasticsearch:9200", "127.0.0.1:9200"]
				sniffing => true
				manage_template => false 
				index => "windows_powershell-%{+YYYY.MM.dd}"
				document_type => "%{[@metadata][type]}"
			}
		}
	}
}